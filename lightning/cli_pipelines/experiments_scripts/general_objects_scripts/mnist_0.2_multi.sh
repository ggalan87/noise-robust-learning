# Original loss
python run.py fit --config ./configs/mnist/config_noisymnist.yaml --config ./configs/common/noise_reduction/no_noise_reduction.yaml --trainer.max_epochs=30 --data.init_args.dataset_args.init_args.labels_noise_perc="{'symmetric': 0.2}"
python run.py fit --config ./configs/mnist/config_noisymnist.yaml --config ./configs/common/noise_reduction/gt_noise_reduction.yaml --trainer.max_epochs=30 --data.init_args.dataset_args.init_args.labels_noise_perc="{'symmetric': 0.2}"
python run.py fit --config ./configs/mnist/config_noisymnist.yaml --config ./configs/common/noise_reduction/knn_noise_reduction.yaml --trainer.max_epochs=30 --data.init_args.dataset_args.init_args.labels_noise_perc="{'symmetric': 0.2}"
python run.py fit --config ./configs/mnist/config_noisymnist.yaml  --config ./configs/common/noise_reduction/prism_nr0.5_noise_reduction.yaml --trainer.max_epochs=30 --data.init_args.dataset_args.init_args.labels_noise_perc="{'symmetric': 0.2}"

# MS Loss
python run.py fit --config ./configs/mnist/config_noisymnist.yaml --config ./configs/common/noise_reduction/no_noise_reduction.yaml --trainer.max_epochs=30 --model.init_args.loss_class=pytorch_metric_learning.losses.MultiSimilarityLoss --model.init_args.loss_kwargs="{}" --data.init_args.dataset_args.init_args.labels_noise_perc="{'symmetric': 0.2}"
python run.py fit --config ./configs/mnist/config_noisymnist.yaml --config ./configs/common/noise_reduction/gt_noise_reduction.yaml --trainer.max_epochs=30 --model.init_args.loss_class=pytorch_metric_learning.losses.MultiSimilarityLoss --model.init_args.loss_kwargs="{}" --data.init_args.dataset_args.init_args.labels_noise_perc="{'symmetric': 0.2}"
python run.py fit --config ./configs/mnist/config_noisymnist.yaml --config ./configs/common/noise_reduction/knn_noise_reduction.yaml --trainer.max_epochs=30 --model.init_args.loss_class=pytorch_metric_learning.losses.MultiSimilarityLoss --model.init_args.loss_kwargs="{}" --data.init_args.dataset_args.init_args.labels_noise_perc="{'symmetric': 0.2}"
python run.py fit --config ./configs/mnist/config_noisymnist.yaml --trainer.max_epochs=30 --model.init_args.loss_class=pytorch_metric_learning.losses.MultiSimilarityLoss --model.init_args.loss_kwargs="{}" --model.init_args.noise_reducer_kwargs="{'strategy': 'torch_metric_learning.noise_reducers.sample_rejection.PRISM', 'keep_only_good_samples': True, 'memory_size': 60000}" --data.init_args.dataset_args.init_args.labels_noise_perc="{'symmetric': 0.2}"

# SubCenterArcFaceLoss
python run.py fit --config ./configs/mnist/config_noisymnist.yaml --config ./configs/common/noise_reduction/no_noise_reduction.yaml --trainer.max_epochs=30 --model.init_args.loss_class=pytorch_metric_learning.losses.SubCenterArcFaceLoss --model.init_args.loss_kwargs="{'optimizer_kwargs': {'lr': 0.003}}" --data.init_args.dataset_args.init_args.labels_noise_perc="{'symmetric': 0.2}"
python run.py fit --config ./configs/mnist/config_noisymnist.yaml --config ./configs/common/noise_reduction/gt_noise_reduction.yaml --trainer.max_epochs=30 --model.init_args.loss_class=pytorch_metric_learning.losses.SubCenterArcFaceLoss --model.init_args.loss_kwargs="{'optimizer_kwargs': {'lr': 0.003}}" --data.init_args.dataset_args.init_args.labels_noise_perc="{'symmetric': 0.2}"
python run.py fit --config ./configs/mnist/config_noisymnist.yaml --config ./configs/common/noise_reduction/knn_noise_reduction.yaml --trainer.max_epochs=30 --model.init_args.loss_class=pytorch_metric_learning.losses.SubCenterArcFaceLoss --model.init_args.loss_kwargs="{'optimizer_kwargs': {'lr': 0.003}}" --data.init_args.dataset_args.init_args.labels_noise_perc="{'symmetric': 0.2}"
python run.py fit --config ./configs/mnist/config_noisymnist.yaml --trainer.max_epochs=30 --model.init_args.loss_class=pytorch_metric_learning.losses.SubCenterArcFaceLoss --model.init_args.loss_kwargs="{'optimizer_kwargs': {'lr': 0.003}}" --model.init_args.noise_reducer_kwargs="{'strategy': 'torch_metric_learning.noise_reducers.sample_rejection.PRISM', 'keep_only_good_samples': True, 'memory_size': 60000}" --data.init_args.dataset_args.init_args.labels_noise_perc="{'symmetric': 0.2}"

# SoftTripleLoss
python run.py fit --config ./configs/mnist/config_noisymnist.yaml --config ./configs/common/noise_reduction/no_noise_reduction.yaml --trainer.max_epochs=30 --model.init_args.loss_class=pytorch_metric_learning.losses.SoftTripleLoss --model.init_args.loss_kwargs="{'optimizer_kwargs': {'lr': 0.003}}" --data.init_args.dataset_args.init_args.labels_noise_perc="{'symmetric': 0.2}"
python run.py fit --config ./configs/mnist/config_noisymnist.yaml --config ./configs/common/noise_reduction/gt_noise_reduction.yaml --trainer.max_epochs=30 --model.init_args.loss_class=pytorch_metric_learning.losses.SoftTripleLoss --model.init_args.loss_kwargs="{'optimizer_kwargs': {'lr': 0.003}}" --data.init_args.dataset_args.init_args.labels_noise_perc="{'symmetric': 0.2}"
python run.py fit --config ./configs/mnist/config_noisymnist.yaml --config ./configs/common/noise_reduction/knn_noise_reduction.yaml --trainer.max_epochs=30 --model.init_args.loss_class=pytorch_metric_learning.losses.SoftTripleLoss --model.init_args.loss_kwargs="{'optimizer_kwargs': {'lr': 0.003}}" --data.init_args.dataset_args.init_args.labels_noise_perc="{'symmetric': 0.2}"
python run.py fit --config ./configs/mnist/config_noisymnist.yaml --trainer.max_epochs=30 --model.init_args.loss_class=pytorch_metric_learning.losses.SoftTripleLoss --model.init_args.loss_kwargs="{'optimizer_kwargs': {'lr': 0.003}}" --model.init_args.noise_reducer_kwargs="{'strategy': 'torch_metric_learning.noise_reducers.sample_rejection.PRISM', 'keep_only_good_samples': True, 'memory_size': 60000}" --data.init_args.dataset_args.init_args.labels_noise_perc="{'symmetric': 0.2}"

# with correct noise
python run.py fit --config ./configs/mnist/config_noisymnist.yaml  --config ./configs/common/noise_reduction/prism_nr0.2_noise_reduction.yaml --trainer.max_epochs=30 --data.init_args.dataset_args.init_args.labels_noise_perc="{'symmetric': 0.2}"
python run.py fit --config ./configs/mnist/config_noisymnist.yaml --trainer.max_epochs=30 --model.init_args.loss_class=pytorch_metric_learning.losses.MultiSimilarityLoss --model.init_args.loss_kwargs="{}" --model.init_args.noise_reducer_kwargs="{'strategy': 'torch_metric_learning.noise_reducers.sample_rejection.PRISM', 'keep_only_good_samples': True, 'memory_size': 60000, 'strategy_kwargs': {'noise_rate': 0.2}}" --data.init_args.dataset_args.init_args.labels_noise_perc="{'symmetric': 0.2}"
python run.py fit --config ./configs/mnist/config_noisymnist.yaml --trainer.max_epochs=30 --model.init_args.loss_class=pytorch_metric_learning.losses.SubCenterArcFaceLoss --model.init_args.loss_kwargs="{'optimizer_kwargs': {'lr': 0.003}}" --model.init_args.noise_reducer_kwargs="{'strategy': 'torch_metric_learning.noise_reducers.sample_rejection.PRISM', 'keep_only_good_samples': True, 'memory_size': 60000, 'strategy_kwargs': {'noise_rate': 0.2}}" --data.init_args.dataset_args.init_args.labels_noise_perc="{'symmetric': 0.2}"
python run.py fit --config ./configs/mnist/config_noisymnist.yaml --trainer.max_epochs=30 --model.init_args.loss_class=pytorch_metric_learning.losses.SoftTripleLoss --model.init_args.loss_kwargs="{'optimizer_kwargs': {'lr': 0.003}}" --model.init_args.noise_reducer_kwargs="{'strategy': 'torch_metric_learning.noise_reducers.sample_rejection.PRISM', 'keep_only_good_samples': True, 'memory_size': 60000, 'strategy_kwargs': {'noise_rate': 0.2}}" --data.init_args.dataset_args.init_args.labels_noise_perc="{'symmetric': 0.2}"

python extract_feats.py --dataset-name NoisyMNIST --target-dataset-name KMNIST --model-name LitModel --versions-range 16 35 --epochs-range 0 30 --batch-keys "image" "target" "data_idx" --parts-list "test"

